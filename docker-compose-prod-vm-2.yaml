version: '3.5'

networks:
  web-app-net:
    name: my-web-app-net
    #driver: overlay
    driver: bridge

services:
  eureka-service-discovery:
    image: engrajibkumerghosh/ms-training-repo-v1:eureka-service-discovery-v1.0.8
    environment:
      management.endpoints.web.exposure.include: health,metrics,httptrace,prometheus
    ports:
      - 801:801
    restart: on-failure
    networks:
      - web-app-net

  api-gateway:
    image: engrajibkumerghosh/ms-training-repo-v1:cloud-gateway-service-v1.0.8
    environment:
      management.endpoints.web.exposure.include: health,metrics,httptrace,prometheus,gateway
      app.eureka.service.host: eureka-service-discovery
      app.eureka.service.port: 801
      redis.host: redis
      redis.port: 6379
    ports:
      - 80:80
    extra_hosts:
      - "eureka-service-discovery:172.30.3.4"
      - "redis:172.30.3.18"
      - "afda21a4e060:172.30.3.6"
      - "5706910580bb:172.30.3.6"
      - "afda21a4e060:172.30.3.7"
      - "5706910580bb:172.30.3.7"
      - "b1f73308401a:172.30.3.6"
      - "c6762d3a79aa:172.30.3.6"
      - "b1f73308401a:172.30.3.7"
      - "c6762d3a79aa:172.30.3.7"
      - "7fdf20fa7d54:172.30.3.8"
      - "c79d253cb822:172.30.3.8"
      - "116490b1ebaf:172.30.3.8"
      - "3fdd4667b10f:172.30.3.8"
      - "77c75dc887e8:172.30.3.16"
      - "47d0101fd590:172.30.3.16"
      - "e84d985766a9:172.30.3.16"
      - "bffc03e6e08a:172.30.3.16"
    restart: on-failure
    networks:
      - web-app-net
#end of scripts